<!DOCTYPE html>
<html>
<head>
    <title>Tetris Mobile</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        /* Styles prÃ©cÃ©dents... */
        #audio-controls {
            position: fixed;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 10px;
        }
        
        .audio-btn {
            background-color: #333;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .audio-btn.active {
            background-color: #4CAF50;
        }
        
        .audio-icon {
            width: 20px;
            height: 20px;
        }
    </style>
</head>
<body>
    <!-- Ajout des contrÃ´les audio -->
    <div id="audio-controls">
        <button id="toggle-music" class="audio-btn">
            ðŸŽµ Musique
        </button>
        <button id="toggle-sfx" class="audio-btn active">
            ðŸ”Š Effets
        </button>
    </div>

    <!-- Contenu prÃ©cÃ©dent... -->
    
    <script>
        // Configuration audio
        const AUDIO = {
            music: new Audio('https://assets.mixkit.co/music/preview/mixkit-game-level-music-689.mp3'),
            rotate: new Audio('https://assets.mixkit.co/sfx/preview/mixkit-arcade-mechanical-bling-210.mp3'),
            move: new Audio('https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-jump-coin-216.mp3'),
            clear: new Audio('https://assets.mixkit.co/sfx/preview/mixkit-arcade-score-interface-217.mp3'),
            drop: new Audio('https://assets.mixkit.co/sfx/preview/mixkit-arcade-retro-changing-tab-206.mp3'),
            gameOver: new Audio('https://assets.mixkit.co/sfx/preview/mixkit-arcade-retro-game-over-213.mp3')
        };

        // Configuration des paramÃ¨tres audio
        let musicEnabled = false;
        let sfxEnabled = true;

        // Configurer la musique de fond
        AUDIO.music.loop = true;
        AUDIO.music.volume = 0.5;

        // Configurer les effets sonores
        Object.values(AUDIO).forEach(audio => {
            if (audio !== AUDIO.music) {
                audio.volume = 0.3;
            }
        });

        // Fonctions de gestion audio
        function playMusic() {
            if (musicEnabled) {
                AUDIO.music.play().catch(() => {
                    // GÃ©rer l'erreur si l'autoplay est bloquÃ©
                    musicEnabled = false;
                    document.getElementById('toggle-music').classList.remove('active');
                });
            }
        }

        function playSfx(soundName) {
            if (sfxEnabled && AUDIO[soundName]) {
                AUDIO[soundName].currentTime = 0;
                AUDIO[soundName].play().catch(() => {});
            }
        }

        // Gestionnaires d'Ã©vÃ©nements pour les boutons audio
        document.getElementById('toggle-music').addEventListener('click', () => {
            musicEnabled = !musicEnabled;
            document.getElementById('toggle-music').classList.toggle('active');
            
            if (musicEnabled) {
                playMusic();
            } else {
                AUDIO.music.pause();
                AUDIO.music.currentTime = 0;
            }
        });

        document.getElementById('toggle-sfx').addEventListener('click', () => {
            sfxEnabled = !sfxEnabled;
            document.getElementById('toggle-sfx').classList.toggle('active');
        });

        // Modifier les fonctions existantes pour ajouter le son

        function rotate() {
            const rotated = currentPiece[0].map((_, i) =>
                currentPiece.map(row => row[row.length - 1 - i])
            );
            
            const prevPiece = currentPiece;
            currentPiece = rotated;
            
            if (collision()) {
                currentPiece = prevPiece;
            } else {
                playSfx('rotate');
            }
        }

        function clearLines() {
            let linesCleared = 0;
            for (let y = BOARD_HEIGHT - 1; y >= 0; y--) {
                if (board[y].every(cell => cell)) {
                    board.splice(y, 1);
                    board.unshift(Array(BOARD_WIDTH).fill(0));
                    linesCleared++;
                    y++;
                }
            }
            if (linesCleared > 0) {
                playSfx('clear');
                const baseScore = linesCleared * 100 * linesCleared;
                const levelMultiplier = LEVEL_SCORE_MULTIPLIERS[level];
                const finalScore = Math.floor(baseScore * levelMultiplier);
                score += finalScore;
                document.getElementById('score-value').textContent = score;
            }
        }

        function gameOverScreen() {
            document.getElementById('game-over').style.display = 'block';
            document.getElementById('final-score').textContent = score;
            AUDIO.music.pause();
            playSfx('gameOver');
        }

        function reset() {
            score = 0;
            gameOver = false;
            board = Array(BOARD_HEIGHT).fill().map(() => Array(BOARD_WIDTH).fill(0));
            document.getElementById('score-value').textContent = '0';
            document.getElementById('game-over').style.display = 'none';
            dropInterval = baseDropInterval * LEVEL_SPEEDS[level];
            playMusic();
            createPiece();
        }

        // Modifier les gestionnaires d'Ã©vÃ©nements pour ajouter le son

        document.addEventListener('keydown', event => {
            if (!gameOver) {
                switch(event.code) {
                    case 'ArrowLeft':
                        currentX--;
                        if (collision()) {
                            currentX++;
                        } else {
                            playSfx('move');
                        }
                        break;
                    case 'ArrowRight':
                        currentX++;
                        if (collision()) {
                            currentX--;
                        } else {
                            playSfx('move');
                        }
                        break;
                    case 'ArrowDown':
                        currentY++;
                        if (collision()) {
                            currentY--;
                            merge();
                            clearLines();
                            createPiece();
                            playSfx('drop');
                        }
                        break;
                    case 'ArrowUp':
                        rotate();
                        break;
                }
            } else if (event.code === 'KeyR') {
                reset();
            }
        });

        // Modifier les contrÃ´les tactiles pour ajouter le son
        document.getElementById('left').addEventListener('click', () => {
            if (!gameOver) {
                currentX--;
                if (collision()) {
                    currentX++;
                } else {
                    playSfx('move');
                }
            }
        });

        document.getElementById('right').addEventListener('click', () => {
            if (!gameOver) {
                currentX++;
                if (collision()) {
                    currentX--;
                } else {
                    playSfx('move');
                }
            }
        });

        document.getElementById('down').addEventListener('click', () => {
            if (!gameOver) {
                currentY++;
                if (collision()) {
                    currentY--;
                    merge();
                    clearLines();
                    createPiece();
                    playSfx('drop');
                }
            }
        });

        document.getElementById('rotate').addEventListener('click', () => {
            if (!gameOver) {
                rotate();
            }
        });

        // Le reste du code reste identique...
    </script>
</body>
</html>
